FROM ghcr.io/open-webui/open-webui:main

# Add wait-for-it script (with proper permissions and line endings)
ADD https://raw.githubusercontent.com/vishnubob/wait-for-it/master/wait-for-it.sh /wait-for-it.sh
RUN chmod +x /wait-for-it.sh && dos2unix /wait-for-it.sh || true

# Wait for DB before running app
ENTRYPOINT ["/wait-for-it.sh", "db:5432", "--"]

# Run the original command
CMD ["bash", "start.sh"]
